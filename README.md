# CATTOOL-Hacker

[toc]

## バージョン

0.3

## 概要

以下のことを実行できます

- XLIFF・TBXのインポート・エクスポート
  - Ver.0.3ではmxliff（Memsource）のみ対応
  - TBXを用語集として使用可能
  
- XLIFFの編集
  - 用語の一括置換
  - 正規表現による翻訳不要箇所のスクリーニング
  - 確定・ロック
  - 機械翻訳
    - Ver.0.2でAtman Cloud Translation と DeepLに対応


## 使い方

### 準備（共通）

#### 基本設定

##### モード（MODE）

configsフォルダ内の **init.txt** をメモ帳などで開きます。

**編集後は、必ずUTF-8で保存してください。**

以下の3種類からモードを選択します。

- REPLACE：用語の置換を行い、必要に応じてロックします
- MT：機械翻訳を行います
- ALL：用語の置換を行い、すべて置き換わった場合は確定してロック、一文字でも置換できなかった場合は機械翻訳を取得します

なお、いずれのモードも事前にTMが入っている場合（訳文に原文と異なる文字列が入っている場合）は処理をスキップします。

##### フェーズ（PHASE）

Memsourceのワークフロー使用時に、何番目のフローの確定を行うかを設定できます。

##### ボーダー（BORDER）

REPLACEモードにおいて、大部分が置き換わった場合にロックの提案をすることができます。その大部分の具体的な割合を指定できます。

##### ロック（LOCK）

Trueにしていると、用語・正規表現のみで置換が完了するセグメントを確定しロックします。
True以外の文字列の場合は確定もロックもしません。


##### 正規表現（EXCLUSION）

翻訳不要として扱う文字列を正規表現として記入します。

例：

- [0-9]+ 数字すべて
- [0-9A-z ]+ 英数字とスペース

#### 用語集設定

TBXを用語集として使用する際に、原文と訳文のロケールを指定する必要があります。

##### 機械翻訳設定

Atman Cloud Translation または DeepLに対応しています。
いずれもAPIプランが必要です。

以下の通り設定してください。

- MT_ENGINE：**ATMAN** または **DEEPL**
- MT_USERNAME：　ユーザー名（メールアドレス） ※DeepLの場合は不要
- MT_PASSWORD：　パスワード ※DeepLの場合はAPIキー
- MT_SOURCE：　原文言語（Atmanならzhかen、DeepLなら対応言語のロケール）
- MT_DOMAIN：ATMANで英語→中国語の翻訳をする際に指定できます。以下の分野から一つを選んでください。（設定しない場合は一般になります）
  - medical
  - medical-pv
  - medical-device
  - medical-cmc
  - medical-clinical
  - medical-nonclinical
  - medical-regulation

#### 用語の準備

configsフォルダ内に タブ区切り形式（tsv）、カンマ区切り形式（csv）またはTBXファイルを入れておくと、すべて用語集として使用できます。

タブ区切り形式（**tb.tsv**など）を作成するには、このファイルをメモ帳などで開き、ExcelなどからコピーすればOKです。

**編集後は、必ずUTF-8で保存してください。**

#### XLIFFファイルの準備

sourceフォルダ内に編集したいxliffファイルを保存してください。

複数ファイルも可です。

### 実行（Windows）

上記の準備が完了したら **main.exe** をダブルクリックして実行します。

実行が完了すると、resultフォルダ内に編集後のxliffファイルと、全テキストのデータ（alltext）、ログファイルが作成されています。

### 実行（Mac/Linux）

直接Pythonファイルを実行します。

実行前にrequestsモジュールとDeepLモジュールが必要になるかもしれません。以下はインストールの一例です。

```bash
pip3 install requests deepl
```

要求を満たしていれば、以下のコマンドでmain.pyを直接実行できます。

```bash
python scripts/main.py
```
